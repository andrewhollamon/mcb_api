TODO

- replace direct calls to viper with a custom struct so we're never passing around type viper.Viper
